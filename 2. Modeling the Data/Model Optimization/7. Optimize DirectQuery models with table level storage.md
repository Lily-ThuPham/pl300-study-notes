The number of users who are opening the reports at any one time will impact the load that is placed on the data source. 
Other factors, such as:
- Network latency; faster networks return data quicker.
- The performance of the data source's server and how many other workloads are on that server.
[DirectQuery](https://learn.microsoft.com/en-us/power-bi/connect-data/desktop-directquery-about#guidance-for-using-directquery-successfully/?azure-portal=true) and a [comprehensive guide](https://learn.microsoft.com/en-us/power-bi/guidance/directquery-model-guidance) of its use in Power BI.
# Implication of using DirectQuery 
DirectQuery might need to be used because of one of the following reasons:
- It is suitable in cases where data changes frequently and near real-time reporting is required.
- It can handle large data without the need to pre-aggregate.
- It applies data sovereignty restrictions to comply with legal requirements.
- It can be used with a multidimensional data source that contains measures such as SAP Business Warehouse (BW

|**Benefit**|**Description**|**Real-Life Scenario**|
|---|---|---|
|**Real-Time Data**|Ensures reports and dashboards always display the latest data by querying the source directly.|A sales dashboard for a multinational retail corporation needs to display new transactions as they are added to the database every hour.|
|**Large Datasets**|Avoids performance problems and high memory consumption by **not** importing massive datasets into the Power BI model.|Analyzing a massive, multi-terabyte transactional database that is too large to be imported into a Power BI file.|
|**Data Security**|**Respects and enforces data source-level security**. All data access permissions defined in the underlying database are automatically applied.|A company needs to ensure that users who view the report can only see the data they are authorized to access, based on their database permissions.|
### 3.0 Behavior of DirectQuery Connections
# Behavior of DirectQuery connections 
Select the data source:
- Relational source: each table of the dataset will define a query that logically returns a set of data 
- Multidimensional source (SAP BW for example): can only select the source 
When loading data: 
- Only the schema is loaded
- When building a visual within Power BI, queries are sent to the underlying source to retrieve the necessary data
If changes are made to the underlying data: 
- won't be immediate reflected and need refresh to see the changes 
When Publish report: 
- Result in a semantic model in Power BI
- No data is included 
When open existing report: 
- underlying source is again queried 
- depending on the location of the original source, you might have to configure an on-premises data gateway.
Pin visuals, report pages, dashboard tiles. 
- The tiles are automatically refreshed on a schedule, for example, every hour. 
- The schedule can be customized 
- Last refresh might not include the latest changes 
# Limitations of DirectQuery connections
- **Performance** - overall user experience depends heavily on the performance of the underlying data source.
- **Security** - It is important to understand how data moves between the underlying data sources and the associated security implications. 
- **Data transformation** DirectQuery has limitations when it comes to applying data transformation techniques within Power Query Editor. For example, if you connect to an OLAP source, such as SAP BW, you can't make any transformations at all; the entire external model is taken from the data source. If you want to make any transformations to the data, you will need to do this in the underlying data source.
- **Modeling** - Some of the modeling capabilities that you have with imported data aren't available, or are limited, when you use DirectQuery.
- **Reporting** - when the report is published in Power BI service, the Quick Insights and Q&A features are not supported. Also, the use of the Explore feature in Excel will likely result in poorer performance.

| **Area**                               | **Limitation**                                                                                                                                                                                                                                                                       |
| -------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Performance**                        | It is almost always slower to query a server (DirectQuery) than it is to query data from in-memory (Import mode). Performance is entirely dependent on the source database, network speed, and query optimization.                                                                   |
| **Data Transformations (Power Query)** | **Limited.** Not all transformations are supported, and the supported transformations vary by the data source. For example, a SQL Server supports some transformations, while SAP BW may support none.                                                                               |
| **Data Modeling & DAX**                | **Limited.** • The built-in **Auto date/time** hierarchy feature is not available. • Some **DAX functions are not available** (e.g., parent-child functions). • Complex DAX measures can cause significant performance issues and should be avoided in favor of simple aggregations. |
| **Power BI Service Features**          | The following AI-driven features are **not supported** for DirectQuery models: • **Quick Insights** • **Q&A**                                                                                                                                                                        |
# Optimize performance 
Using **Performance analyzer**, where you can isolate queries to validate query plans and identify the bottlenecks.
Apply the same optimization techniques that used on imported data to tune the data from DirectQuery source.
- Optimize data model/sematic model 
- Optimize tables storage
# Optimize the underlying data source (connected database)
Standard Database practice: 
- Avoid the use of complex calculated columns because calculation expression will be embedded into the source queries. 
- Consider adding surrogate key to columns to dimension-type tables. 
- Review the indexes and verify that the current indexing is correct.
# Customize the Query reduction options 
Power BI offers option to send fewer queries and to disable certain interactions.
Many Filters or slicers will lead to a redundant of queries which results into slow performance. 
Select **File** **>** **Options and settings** **>** **Options**, scrolling down the page, and then selecting the **Query reduction** option.
- **Reduce number of queries sent by** - By default, every visual interacts with every other visual. Selecting this check box disables that default interaction. You can then optionally choose which visuals interact with each other by using the **Edit interactions** feature.
- **Slicers** - By default, the **Instantly apply slicer changes** option is selected. To force the report users to manually apply slicer changes, select the **Add an apply button to each slicer to apply changes when you're ready** option.
- **Filters**:
    - **Instantly apply basic filter changes**: chosen by default
    - **Add an apply button to all basic filters to apply changes when you're ready**
    - **Add a single apply button to the filter pane to apply changes at once (preview)**
    - **Tip:** The third option is highly recommended to avoid unwanted changes, especially when you have a multi-selection filter. You can choose to have one **Apply** button for the entire filter pane, which is helpful in query reduction.

⚠️Disabling slicer interactions reduces the number of queries generated by user actions but does not directly improve query efficiency. 
# Optimizing with table storage 
Optimizing tables storage allow to store selected tables to the memory for faster query performance. 
**Storage Mode Options:** 
- **Import:** Data is stored in Power BI's in-memory storage.
- **DirectQuery:** Data remains in the original data source.
- **Dual:** A combination of import and DirectQuery.
**Optimizing DirectQuery Performance:**
- Reduce the number of queries sent to the database.
- Enhance query performance.
Table storage and how to manage them(https://learn.microsoft.com/en-us/power-bi/transform-model/desktop-storage-mode)
## Composite mode 
Combine DirectQuery and Import modes for optimal performance 
- Fact tables: typically in DirectQuery mode for large datasets 
- Dimension Tables: often imported for smaller datasets 
# Assume Referential Integrity
**Assume Referential Integrity** is an advanced setting for relationships in **DirectQuery** mode. Its purpose is to improve query performance by changing the type of join Power BI uses.
- **Without the setting (Default):** Power BI uses a `LEFT OUTER JOIN`. This is a safe but slower join that includes all rows from the "many" side table, even if there's no matching row in the "one" side table.
- **With the setting enabled:** Power BI uses a more efficient `INNER JOIN`. This is a faster join that only includes rows where a match is found in both tables.
This setting should only be enabled when you can guarantee the integrity of your data.
## Requirements for Use
You can only enable this setting if your data meets **both** of the following strict conditions for the relationship
1. The column on the **"Many"** side of the relationship (the `From` column) **is never Null or blank**.
2. For every value in the "Many" side column, a **corresponding value exists** in the "One" side column (the `To` column).
In simple terms, there are no "orphan" records in your fact table.
## How to Enable the Setting
1. In the Power BI Desktop model view, double-click the relationship line to open the **Edit relationship** dialog.
2. At the bottom of the dialog, check the box for **Assume referential integrity**.
3. Click **OK**.
## Consequences of Incorrectly Setting It ⚠️
This is a critical concept for the exam. If you enable this setting when your data does not meet the requirements, Power BI **will not show an error message**. Instead, it will lead to **silent data inconsistencies and incorrect results**.
**Example from the Source:**
- Imagine an `Orders` table has an order with a `DepotID` that is `Null`.
- The true total `Order Qty` for all orders is **40**.
- A card visual showing the total `Order Qty` will correctly show **40**.
- However, a bar chart showing `Order Qty` by `Depot City` will only show a total of **30**.

**Why this happens:** The `INNER JOIN` used by the bar chart (which needs data from the `Depots` table) will drop the order with the `Null` `DepotID` because it can't find a match. The card visual, which only needs data from the `Orders` table, doesn't perform a join and thus shows the correct grand total. This leads to a confusing report where the details do not add up to the total.